<!DOCTYPE html>
<html>
<meta charset="UTF-8">

<link rel="stylesheet" type="text/css" href="index.css">
<link rel="stylesheet" type="text/css" href="create_form.css">

<body>
    <div id="header">
        <div id="raon-logo">
            <svg width="120" height="31">
                <path style="fill:#f2f2f2"
                    d="M82.57,4.54c-7.08,0-12.82,5.79-12.82,12.94s5.74,12.94,12.82,12.94,12.82-5.79,12.82-12.94-5.74-12.94-12.82-12.94ZM82.57,25.34c-4.2,0-7.61-3.52-7.61-7.87s3.41-7.87,7.61-7.87,7.61,3.52,7.61,7.87-3.41,7.87-7.61,7.87Z" />
                <path style="fill:#f2f2f2"
                    d="M58.08,4.54c-1.03,0-1.91.61-2.31,1.49l-10.48,22.98-5.86-6.81-1.72-1.87c2.34-.02,4.12-.63,5.52-1.92,1.56-1.44,2.54-3.48,2.54-5.75,0-4.34-3.58-7.87-7.99-7.87h-13.2s-.01,0-.02,0h-10.8c-.95-2.78-3.58-4.79-6.69-4.79C3.17,0,0,3.17,0,7.07s3.17,7.07,7.07,7.07c3.11,0,5.74-2,6.69-4.79h16.26s7.25,0,7.25,0c1.82,0,3.3,1.48,3.3,3.3s-1.48,3.3-3.3,3.3h-6.85c-.63,0-1.14.51-1.14,1.14,0,.28.09.53.26.73l10.02,12.34h6.73,0s4.05,0,4.05,0l2.58-5.84h10.34l2.58,5.84h5.58l-11.01-24.14c-.4-.88-1.28-1.49-2.31-1.49ZM54.82,20.01l2.24-5.07,1-2.54h.04l1,2.54,2.24,5.07h-6.53Z" />
                <path style="fill:#f2f2f2"
                    d="M114.92,4.79v12.69l.03,3.81h-.03l-2.75-3.81-9.19-11.93c-.46-.61-1.2-1.01-2.02-1.01-1.4,0-2.54,1.14-2.54,2.54v23.09h5.08v-12.69l-.03-3.8h.03l2.75,3.8,9.19,11.94c.46.61,1.2,1.01,2.02,1.01,1.4,0,2.54-1.14,2.54-2.54V4.79h-5.08Z" />
            </svg>
        </div>
        <div id="title">COntrol Message Alarm</div>
        <div id="search">
            <div id="new-alarm" onclick="showAlarmConfigurationDialog('create', null)">+</div>
            <div id="search-bar">
                <input type="text" id="search-input" placeholder="Search">
                <div type="button" id="search-button">
                    <svg width="22" height="22">
                        <path style="fill:#b3b3b3"
                            d="M21.71,20.29l-5.91-5.91c2.77-3.48,2.55-8.57-.66-11.78-1.67-1.67-3.9-2.6-6.27-2.6S4.27.92,2.6,2.6C.92,4.27,0,6.5,0,8.86s.92,4.59,2.6,6.27c1.73,1.73,4,2.59,6.27,2.59,1.96,0,3.91-.65,5.52-1.93l5.91,5.91c.2.2.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.02,0-1.41ZM4.01,13.72c-1.3-1.3-2.01-3.02-2.01-4.85s.71-3.56,2.01-4.85,3.02-2.01,4.85-2.01,3.56.71,4.85,2.01c2.68,2.68,2.68,7.03,0,9.71-2.68,2.67-7.03,2.68-9.71,0Z" />
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <div id="alarm-summary-container">
        <div id="summary-normal-icon">
            <svg width="50" height="50">
                <circle style="fill:#22b573" cx="25" cy="25" r="25" />
                <path style="fill:#eee"
                    d="M23.84,37.23c-1.2,0-2.28-.59-2.93-1.59l-7.48-9.51c-.68-.87-.53-2.12.33-2.81.87-.68,2.13-.53,2.81.33l7.17,9.12,9.47-18.9c.49-.99,1.7-1.39,2.68-.89.99.49,1.39,1.7.89,2.68l-9.94,19.83c-.63,1.09-1.76,1.74-3.01,1.74Z" />
            </svg>
        </div>
        <div id="summary-normal-text">69</div>
        <div id="summary-alarm-icon">
            <svg width="50" height="45">
                <defs>
                    <style>
                        .cls-4 {
                            fill: #eee;
                            font-family: Roboto-Black, Roboto;
                            font-size: 30.15px;
                            font-weight: 800;
                        }
                    </style>
                </defs>
                <path style="fill:#d4145a"
                    d="M22.4,1.5L.41,39.6c-1.15,2,.29,4.5,2.6,4.5h43.99c2.31,0,3.75-2.5,2.6-4.5L27.6,1.5c-1.15-2-4.04-2-5.2,0Z" />
                <text class="cls-4" transform="translate(20.84 36.58)">
                    <tspan x="0" y="0">!</tspan>
                </text>
            </svg>

        </div>
        <div id="summary-alarm-text">12</div>

    </div>
    <div id="alarm-list-title">
        <div id="title-activation"></div>
        <div id="title-pvname">Process Variable</div>
        <div id="title-value">Value</div>
        <div id="title-condition">Condition</div>
        <div id="title-status">Status</div>
        <div id="title-delay">Delay</div>
        <div id="title-repetation">Repetation</div>
        <div id="title-phone">Phone</div>
        <div id="title-edit">Edit</div>
        <div id="title-delete">Delete</div>
    </div>
    <div id="alarm-list-container">
        <div class="alarmItem">
            <div class="alarmInfo">
                <div class="alarmActivation"></div>
                <div class="alarmPVName">SYS-SUBSYS:DEV-SUBDEV:Signal</div>
                <div class="alarmValue">6.19E-6</div>
                <div class="alarmCondition">&#8805</div>
                <div class="alarmStatus">
                    <svg width="40" height="40">
                        <circle class="icon-normal" cx="20" cy="20" r="20" />
                        <path class="icon-fill"
                            d="M19.11,29.82h0c-1.06,0-2.04-.54-2.62-1.41l-5.71-7.26c-.68-.87-.53-2.12.33-2.81.87-.68,2.13-.53,2.81.33l5.03,6.39,6.91-13.79c.49-.99,1.7-1.39,2.68-.89.99.49,1.39,1.7.89,2.68l-7.61,15.19c-.56.97-1.6,1.57-2.71,1.57Z" />
                    </svg>
                </div>
                <div class="alarmDelay">5sec</div>
                <div class="alarmRepetation">60min</div>
                <div class="alarmPhone">
                    <svg width="22" height="30">
                        <path class="icon-fill"
                            d="M7.66,22.73h0c-1.5-.91-2.01-2.84-1.13-4.36l4.88-8.46c.88-1.52,2.81-2.05,4.34-1.2h0s.52.3.52.3c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74L16.31.1c-1.54-.89-6.33,4.53-10.7,12.1C1.24,19.77-1.06,26.63.48,27.52l3.83,2.21c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74l-.52-.3Z" />
                    </svg>
                </div>
                <div class="alarmEdit">
                    <svg width="19" height="30">
                        <path class="icon-fill"
                            d="M0,25.01v4.42c0,.44.48.72.86.5l3.83-2.21c.17-.1.32-.24.42-.42L16.39,7.75l-4.95-2.86L.15,24.44c-.1.17-.15.37-.15.57Z" />
                        <path class="icon-fill"
                            d="M17.34.38c-1.37-.79-3.12-.32-3.9,1.05l-1.43,2.48,4.95,2.86,1.43-2.48c.79-1.37.32-3.12-1.05-3.9Z" />
                    </svg>
                </div>
                <div class="alarmDelete">
                    <svg width="22" height="30">
                        <path class="icon-fill"
                            d="M.62,5.96l2.39,22.66c.02.77.65,1.38,1.42,1.38h12.44c.77,0,1.4-.61,1.42-1.38l2.39-22.66H.62ZM7.27,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58ZM11.5,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58ZM15.74,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58Z" />
                        <path class="icon-fill"
                            d="M19.29,1.7h-6.95c0-.94-.76-1.7-1.7-1.7s-1.7.76-1.7,1.7H2C.9,1.7,0,2.6,0,3.7v.84h21.29v-.84c0-1.1-.9-2-2-2Z" />
                    </svg>
                </div>
            </div>
            <div class="smsInfo">
                <div class="smsActivation">
                    <svg width="20" height="20">
                        <rect class="cls-11" width="20" height="20" rx="2" ry="2" style="fill:#22b573" />
                        <path class="cls-12"
                            d="M9.44,15.9c-.59,0-1.12-.29-1.44-.78l-3.59-4.56c-.34-.43-.27-1.06.17-1.4.43-.34,1.06-.27,1.4.17l3.4,4.32,4.51-9c.25-.49.85-.69,1.34-.45.49.25.69.85.45,1.34l-4.74,9.45c-.34.59-.89.91-1.51.91Z"
                            style="fill: #eee;" />
                    </svg>
                </div>
                <div class="smsPhoneNumber">0428788831</div>
                <div class="smsDelete">
                    <svg width="25" height="25">
                        <circle cx="12.5" cy="12.5" r="12.5" style="fill:#d4145a" />
                        <rect x="5" y="10.5" width="15" height="4" style="fill:#eee" />
                    </svg>
                </div>
            </div>
            <div class="smsInfo">
                <div class="smsActivation">
                    <svg width="20" height="20">
                        <rect class="cls-11" width="20" height="20" rx="2" ry="2" style="fill:#22b573" />
                        <path class="cls-12"
                            d="M9.44,15.9c-.59,0-1.12-.29-1.44-.78l-3.59-4.56c-.34-.43-.27-1.06.17-1.4.43-.34,1.06-.27,1.4.17l3.4,4.32,4.51-9c.25-.49.85-.69,1.34-.45.49.25.69.85.45,1.34l-4.74,9.45c-.34.59-.89.91-1.51.91Z"
                            style="fill: #eee;" />
                    </svg>
                </div>
                <div class="smsPhoneNumber">0428788831</div>
                <div class="smsDelete">
                    <svg width="25" height="25">
                        <circle cx="12.5" cy="12.5" r="12.5" style="fill:#d4145a" />
                        <rect x="5" y="10.5" width="15" height="4" style="fill:#eee" />
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <!-- New Alarm Form -->
    <div id="config-dialog-body">
        <form id="config-form-container">
            <div class="configFormCancelButton" onclick="closeAlarmConfigurationDialog()">
                <svg width="30" height="30">
                    <circle cx="15" cy="15" r="15" style="fill:#d41c5c" />
                    <polygon style="fill:#eeedee"
                        points="22.41 10.41 19.59 7.59 15 12.17 10.41 7.59 7.59 10.41 12.17 15 7.59 19.59 10.41 22.41 15 17.83 19.59 22.41 22.41 19.59 17.83 15 22.41 10.41" />
                </svg>

            </div>
            <div class="configFormItem">
                <label>Process Variable</label>
                <input id="config-pvname" type="text" name="pvname">
            </div>

            <div class="configFormItem">
                <label>Value</label>
                <div class="configFormItemChild">
                    <div class="configFormChildItem">
                        <input id="config-value" type="text" pattern="[0-9]" title="Number" name="value"
                            style="width: 130px; margin-right: 20px;">
                    </div>
                    <div class="configFormChildItem">
                        <select id="config-condition" name="condition" style="width: 70px; margin-right: 40px;">
                            <option value="0" selected="selected">&#61</option>
                            <option value="1">&#60</option>
                            <option value="2">&#62</option>
                            <option value="3">&#8800</option>
                            <option value="4">&#8804</option>
                            <option value="5">&#8805</option>
                        </select>
                    </div>
                    <div class="configFormChildItem">
                        <select id="config-delay" name="delay" style="width: 70px; margin-right: 20px;">
                            <option value="0">0s</option>
                            <option value="5" selected="selected">5s</option>
                            <option value="10">10s</option>
                            <option value="30">30s</option>
                            <option value="60">60s</option>
                        </select>
                    </div>
                    <div class="configFormChildItem">
                        <select id="config-repetation" name="repetation" style="width: 70px; margin-right: 0px;">
                            <option value="0" selected="selected">No</option>
                            <option value="5">5m</option>
                            <option value="10">10m</option>
                            <option value="30">30m</option>
                            <option value="60">60m</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="configFormItem" style="margin-top: 60px">
                <div class="configFormItemChild">
                    <label>Message List</label>
                    <div class="configMessageUserAddButton" type="button" onclick="addMessageUser()">
                        <svg width="26" height="26">
                            <circle style="fill:#29abe2" cx="13" cy="13" r="13" />
                            <polygon style="fill:#eee"
                                points="20.8 11 15 11 15 5.2 11 5.2 11 11 5.2 11 5.2 15 11 15 11 20.8 15 20.8 15 15 20.8 15 20.8 11" />
                        </svg>
                    </div>
                </div>

                <div id="config-message-user-list">
                    <div class="configMessageUserListContainer">
                        <div class="configMessagePhoneIcon">
                            <svg width="22" height="30">
                                <path style="fill:#eeeeee"
                                    d="M7.66,22.73h0c-1.5-.91-2.01-2.84-1.13-4.36l4.88-8.46c.88-1.52,2.81-2.05,4.34-1.2h0s.52.3.52.3c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74L16.31.1c-1.54-.89-6.33,4.53-10.7,12.1C1.24,19.77-1.06,26.63.48,27.52l3.83,2.21c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74l-.52-.3Z" />
                            </svg>
                        </div>
                        <div class="configMessagePhoneNumber">0428788841</div>
                        <div class="configMessagePhoneDelete">
                            <svg width="25" height="25">
                                <circle cx="12.5" cy="12.5" r="12.5" style="fill:#d4145a" />
                                <rect x="5" y="10.5" width="15" height="4" style="fill:#eee" />
                            </svg>
                        </div>
                    </div>
                </div>

                <button id="config-set-button" type="button" class="configSetButton"></button>
            </div>
        </form>
    </div>
</body>
<script>

    const SVG_ALARM_STAT = '<svg width="40" height="35"><path class="icon-alarm" d="M17.44,1.5L.41,31c-1.15,2,.29,4.5,2.6,4.5h34.06c2.31,0,3.75-2.5,2.6-4.5L22.63,1.5c-1.15-2-4.04-2-5.2,0Z" /><circle class="icon-fill" cx="20.04" cy="27.82" r="2.54" /><path class="icon-fill" d="M20.04,9.18c-1.4,0-2.54,1.14-2.54,2.54l1.02,12.19h3.05l1.02-12.19c0-1.4-1.14-2.54-2.54-2.54Z" /></svg>';
    const SVG_NORMAL_STAT = '<svg width="40" height="40"><circle class="icon-normal" cx="20" cy="20" r="20" /><path class="icon-fill" d="M19.11,29.82h0c-1.06,0-2.04-.54-2.62-1.41l-5.71-7.26c-.68-.87-.53-2.12.33-2.81.87-.68,2.13-.53,2.81.33l5.03,6.39,6.91-13.79c.49-.99,1.7-1.39,2.68-.89.99.49,1.39,1.7.89,2.68l-7.61,15.19c-.56.97-1.6,1.57-2.71,1.57Z" /></svg>';
    const SVG_PHONE = '<svg width="22" height="30"><path class="icon-fill" d="M7.66,22.73h0c-1.5-.91-2.01-2.84-1.13-4.36l4.88-8.46c.88-1.52,2.81-2.05,4.34-1.2h0s.52.3.52.3c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74L16.31.1c-1.54-.89-6.33,4.53-10.7,12.1C1.24,19.77-1.06,26.63.48,27.52l3.83,2.21c.96.55,2.19.23,2.74-.73l1.86-3.22c.55-.96.23-2.19-.73-2.74l-.52-.3Z" /></svg>';
    const SVG_EDIT = '<svg width="19" height="30"><path class="icon-fill" d="M0,25.01v4.42c0,.44.48.72.86.5l3.83-2.21c.17-.1.32-.24.42-.42L16.39,7.75l-4.95-2.86L.15,24.44c-.1.17-.15.37-.15.57Z" /><path class="icon-fill" d="M17.34.38c-1.37-.79-3.12-.32-3.9,1.05l-1.43,2.48,4.95,2.86,1.43-2.48c.79-1.37.32-3.12-1.05-3.9Z" /></svg>';
    const SVG_DELETE = '<svg width="22" height="30"><path class="icon-fill" d="M.62,5.96l2.39,22.66c.02.77.65,1.38,1.42,1.38h12.44c.77,0,1.4-.61,1.42-1.38l2.39-22.66H.62ZM7.27,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58ZM11.5,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58ZM15.74,22.39c0,.44-.36.8-.8.8h-.12c-.44,0-.8-.36-.8-.8v-10.58c0-.44.36-.8.8-.8h.12c.44,0,.8.36.8.8v10.58Z" /><path class="icon-fill" d="M19.29,1.7h-6.95c0-.94-.76-1.7-1.7-1.7s-1.7.76-1.7,1.7H2C.9,1.7,0,2.6,0,3.7v.84h21.29v-.84c0-1.1-.9-2-2-2Z" /></svg>';
    const SVG_PHONE_DELETE = '<svg width="25" height="25"><circle cx="12.5" cy="12.5" r="12.5" style="fill:#d4145a"/><rect x="5" y="10.5" width="15" height="4" style="fill:#eee" /></svg>';
    const SVG_PHONE_ACTIVATION = '<svg width="20" height="20"><path class="cls-12" d="M9.44,15.9c-.59,0-1.12-.29-1.44-.78l-3.59-4.56c-.34-.43-.27-1.06.17-1.4.43-.34,1.06-.27,1.4.17l3.4,4.32,4.51-9c.25-.49.85-.69,1.34-.45.49.25.69.85.45,1.34l-4.74,9.45c-.34.59-.89.91-1.51.91Z" style="fill: #eee;"/></svg>';

    getAlarmData();

    function getAlarmData() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var jsonValue = JSON.parse(this.responseText);
                for (let x in jsonValue) {
                    createAlarmData(jsonValue[x]);
                }
            }
            // else {
            // 	alert('Status Error : ' + this.status);
            // }

        };

        var serverAddr = "http://192.168.131.161:8000/getAlarmData";
        xhttp.open("GET", serverAddr, false);
        xhttp.send();
    }

    function getSMSListFromPV(pvname) {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                var jsonValue = JSON.parse(this.responseText);
                // console.log(jsonValue);
                for (let x in jsonValue) {
                }
            }
            // else {
            // 	alert('Status Error : ' + this.status);
            // }

        };

        var serverAddr = "http://192.168.131.161:8000/get";
        xhttp.open("GET", serverAddr, false);
        xhttp.send();
    }

    function createAlarmData(data) {
        let alarmListContainer = document.getElementById('alarm-list-container');

        const alarmItemContainer = document.createElement('div');
        alarmItemContainer.classList.add('alarmItem');

        // Alarm Infomation
        const alarmInfoContainer = document.createElement('div');
        alarmInfoContainer.classList.add('alarmInfo');

        const activationElem = document.createElement('div');
        activationElem.classList.add('alarmActivation');

        const activationContainerElem = document.createElement('label');
        activationContainerElem.classList.add('activationContainer');

        const activationInput = document.createElement('input');
        activationInput.classList.add('activationCheckBox');
        activationInput.setAttribute('type', 'checkbox');
        activationInput.addEventListener('change', () => {
            setAlarmActivation(activationInput);
        });

        const activationToggle = document.createElement('span');
        activationToggle.classList.add('activationToggelButton');

        activationContainerElem.appendChild(activationInput);
        activationContainerElem.appendChild(activationToggle);
        activationElem.appendChild(activationContainerElem);

        const pvnameElem = document.createElement('div');
        pvnameElem.classList.add('alarmPVName');
        pvnameElem.innerText = data['pvname'];

        const valueElem = document.createElement('div');
        valueElem.classList.add('alarmValue')
        valueElem.innerText = data['value'];

        const conditionElem = document.createElement('div');
        conditionElem.classList.add('alarmCondition');
        conditionElem.innerHTML = convertContition(data['operator'])

        const statusElem = document.createElement('div');
        statusElem.classList.add('alarmStatus');
        statusElem.innerHTML = alarmStateCheck(data['state']);

        const delayElem = document.createElement('div');
        delayElem.classList.add('alarmDelay');
        delayElem.innerText = data['delay'] + 'sec';

        const repetationElem = document.createElement('div');
        repetationElem.classList.add('alarmRepetation');
        repetationElem.innerText = data['repetation'] + 'min';

        const phoneElem = document.createElement('div');
        phoneElem.classList.add('alarmPhone');
        phoneElem.innerHTML = SVG_PHONE;
        phoneElem.addEventListener('click', () => {
            displaySMSList(alarmItemContainer);
        });

        const editElem = document.createElement('div');
        editElem.classList.add('alarmEdit');
        editElem.innerHTML = SVG_EDIT;
        editElem.addEventListener('click', () => {
            showAlarmConfigurationDialog('update', data);
        });

        const deleteElem = document.createElement('div');
        deleteElem.classList.add('alarmDelete');
        deleteElem.innerHTML = SVG_DELETE;
        deleteElem.addEventListener('click', () => {
            deleteAlarmItem(alarmItemContainer);
        });

        alarmInfoContainer.appendChild(activationElem);
        alarmInfoContainer.appendChild(pvnameElem);
        alarmInfoContainer.appendChild(valueElem);
        alarmInfoContainer.appendChild(conditionElem);
        alarmInfoContainer.appendChild(statusElem);
        alarmInfoContainer.appendChild(delayElem);
        alarmInfoContainer.appendChild(repetationElem);
        alarmInfoContainer.appendChild(phoneElem);
        alarmInfoContainer.appendChild(editElem);
        alarmInfoContainer.appendChild(deleteElem);

        alarmItemContainer.appendChild(alarmInfoContainer);

        // SMS Information
        // console.log(data);
        for (let sms of data['sms']) {
            const smsInfoContainer = document.createElement('div');
            smsInfoContainer.classList.add('smsInfo');
            smsInfoContainer.style.display = 'none';

            const smsActivationElem = document.createElement('div');
            smsActivationElem.classList.add('smsActivation');

            const smsActivationContainerElem = document.createElement('label');
            smsActivationContainerElem.classList.add('smsActivationContainer');

            const smsActivationInput = document.createElement('input');
            smsActivationInput.classList.add('smsActivationCheckBox');
            smsActivationInput.setAttribute('type', 'checkbox');
            smsActivationInput.addEventListener('change', () => {
                setSMSActivation(smsActivationInput);
            });

            const smsActivationCheck = document.createElement('span');
            smsActivationCheck.classList.add('smsActivationCheckButton');
            smsActivationCheck.innerHTML = SVG_PHONE_ACTIVATION;


            smsActivationContainerElem.appendChild(smsActivationInput);
            smsActivationContainerElem.appendChild(smsActivationCheck);
            smsActivationElem.appendChild(smsActivationContainerElem);


            const smsPhoneNumberElem = document.createElement('div');
            smsPhoneNumberElem.classList.add('smsPhoneNumber');

            smsPhoneNumberElem.innerText = sms['phone']

            const smsDeleteElem = document.createElement('div');
            smsDeleteElem.classList.add('smsDelete');
            smsDeleteElem.innerHTML = SVG_PHONE_DELETE;

            smsInfoContainer.appendChild(smsActivationElem);
            smsInfoContainer.appendChild(smsPhoneNumberElem);
            smsInfoContainer.appendChild(smsDeleteElem);

            alarmItemContainer.appendChild(smsInfoContainer);
        }

        alarmListContainer.appendChild(alarmItemContainer);

    }

    function addAlarmItem() {

    }

    function deleteAlarmItem(elem) {
        console.log(elem);
        // elem.remove();
    }

    function setAlarmActivation(elem) {
        let isChecked = elem.checked;
        console.log(isChecked);
    }

    function setSMSActivation(elem) {
        let isChecked = elem.checked;
        console.log(isChecked);
    }

    function displaySMSList(container) {
        const smsNodes = container.getElementsByClassName('smsInfo');
        console.log(smsNodes);

        for (let i = 0; i < smsNodes.length; i++) {
            let id = smsNodes[i];
            console.log(id.style.display);
            if (id.style.display == 'none') {
                id.style.display = "flex";
            }
            else {
                id.style.display = "none";
            }
        }
    }

    function convertContition(operator) {
        switch (operator) {
            case 0:
                return '&#61';

            case 1:
                return '&#60';

            case 2:
                return '&#62';

            case 3:
                return '&#8800';

            case 4:
                return '&#8804';

            case 5:
                return '&#8805';

            default:
                return 'Error';
        }
    }

    function alarmStateCheck(state) {
        switch (state) {
            case 'alarm':
                return SVG_ALARM_STAT;
            case 'normal':
                return SVG_NORMAL_STAT;

            default:
                return 'Error';
        }
    }

    function addMessageUser() {
        const messageList = document.getElementById('config-message-user-list');

        const messageListItemElem = document.createElement('div');
        messageListItemElem.classList.add('configMessageUserListContainer');

        const phoneIconElem = document.createElement('div');
        phoneIconElem.classList.add('configMessagePhoneIcon');
        phoneIconElem.innerHTML = SVG_PHONE;

        const phoneInputElem = document.createElement('input');
        phoneInputElem.classList.add('configMessageInputPhone');
        phoneInputElem.setAttribute('name', 'phone');
        phoneInputElem.setAttribute('type', 'tel');
        phoneInputElem.setAttribute('pattern', '[0-9]{10,}');
        phoneInputElem.setAttribute('placeholder', '01046821357');
        phoneInputElem.addEventListener('focusout', () => {
            let value = phoneInputElem.value;
            // console.log(Number.isInteger(value));
            if (!value) {
                messageListItemElem.remove();
            }
        });
        // phoneInputElem.addEventListener('keypress', (event) => {
        //     if(event.key == "Enter") {
        //         event.preventDefault();
        //         phoneInputElem.dispatchEvent(new Event('focusout'));
        //         console.log(event.key);
        //     }
        // });

        const phoneDeleteElem = document.createElement('div');
        phoneDeleteElem.classList.add('configMessagePhoneDelete');

        messageListItemElem.appendChild(phoneIconElem);
        messageListItemElem.appendChild(phoneInputElem);
        messageListItemElem.appendChild(phoneDeleteElem);

        messageList.insertBefore(messageListItemElem, messageList.firstChild);
    }


    function showAlarmConfigurationDialog(target, data) {

        switch (target) {
            case 'create':
                var searchInputId = document.getElementById('search-input');
                document.getElementById('config-pvname').value = searchInputId.value;

                var createButtonID = document.getElementById('config-set-button');
                createButtonID.innerText = 'Create';
                createButtonID.addEventListener('click', () => {
                    let formData = new FormData(document.getElementById('config-form-container'));
                    // console.log(formData);
                    createNewAlarmInfo(formData);
                });
                break;

            case 'update':
                console.log(data);
                // document.getElementById('config-pvname').value = data['pvname'];
                // document.getElementById('config-value').value = data['value'];
                // docuemnt.getElementById('config-delay').value = data['delay'];
                // docuemnt.getElementById('config-repetation').value = data['repetation'];

                var createButtonID = document.getElementById('config-set-button');
                createButtonID.innerText = 'Update';
                createButtonID.addEventListener('click', () => {
                    let formData = new FormData(document.getElementById('config-form-container'));
                    updateAlarmInfo(formData);
                });

                break;

        }

        let id = document.getElementById('config-dialog-body');
        id.style.display = 'flex';
    }

    function closeAlarmConfigurationDialog() {
        let id = document.getElementById('config-dialog-body');
        id.style.display = 'none';
    }

    function createNewAlarmInfo(data) {
        const dicData = {};
        const phoneArray = [];

        for (let [key, value] of data.entries()) {
            if (key == 'phone') {
                phoneArray.push(value);
            }
            else {
                dicData[key] = value;
            }
            // console.log(`${key}: ${value}`);
        }

        dicData['phone'] = phoneArray;
    }

    function updateAlarmInfo(data) {
        for (let [key, value] of data.entries()) {
            console.log(`${key}: ${value}`);
        }
    }


</script>

</html>